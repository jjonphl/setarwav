
stopifnot(all(convolve.rcpp(c(1,2,3),c(1,2))==c(1,4,7,6)))

d4.s <- c(0.34150635, 0.59150635, 0.15849365, -0.09150635)
d4.h <- c(-0.09150635, -0.15849365, 0.59150635, -0.34150635)


d4.h.l2 <- c(-0.03125000, -0.05412659, -0.06862976, 
             -0.08537659,  0.17688294,  0.36438294,
             -0.02287659, -0.25612976, -0.05412659,  0.03125000)
d4.s.l2 <- c(0.116626588, 0.202003175, 0.256129763,  
             0.318629763, 0.147876588, 0.039623412, 
             -0.006129763, -0.068629763, -0.014503175, 0.008373412)

d4.s.l3 <- c( 0.0398287204,  0.0689853673,  0.0874699408, 
              0.1088140877,  0.1194861612,  0.1330178081, 
              0.1494090285,  0.1650340285,  0.1010015877, 
              0.0583132939,  0.0369691469,  0.0099058531, 
              0.0041867061, -0.0072515877, -0.0244090285,
             -0.0400340285, -0.0158303081, -0.0022986612, 
              0.0005609123,  0.0062800592,  0.0013271327, -0.0007662204)
d4.h.l3 <- c(-0.010672073, -0.018484573, -0.023437500,
             -0.029156647, -0.032016220, -0.035642014, 
             -0.040034029, -0.044220735,  0.046875000,
              0.112439882,  0.152473910,  0.199348910, 
              0.049939882, -0.046875000, -0.091095735,
             -0.149409029, -0.059079514, -0.008578720, 
              0.002093353,  0.023437500,  0.004952927, -0.002859573)

stopifnot(all.equal(d4.s.l2, convolve.rcpp(up.sample(d4.s,1), d4.s), tol=2e-8))
stopifnot(all.equal(d4.h.l2, convolve.rcpp(up.sample(d4.h,1), d4.s), tol=2e-8))
stopifnot(all.equal(d4.s.l3, convolve.rcpp(up.sample(d4.s,3), d4.s.l2), tol=2e-8))
stopifnot(all.equal(d4.h.l3, convolve.rcpp(up.sample(d4.h,3), d4.s.l2), tol=2e-8))
